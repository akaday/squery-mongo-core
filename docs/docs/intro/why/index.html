<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.66">
<title data-react-helmet="true">  | cMQL</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_language" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="  | cMQL"><meta data-react-helmet="true" name="description" content="Why cMQL"><meta data-react-helmet="true" property="og:description" content="Why cMQL"><meta data-react-helmet="true" property="og:url" content="https://tkaryadis.github.io/cmql-core/docs/intro/why"><link data-react-helmet="true" rel="shortcut icon" href="/cmql-core/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://tkaryadis.github.io/cmql-core/docs/intro/why"><link rel="stylesheet" href="/cmql-core/styles.495a138b.css">
<link rel="preload" href="/cmql-core/styles.feaccdac.js" as="script">
<link rel="preload" href="/cmql-core/runtime~main.d60d5b06.js" as="script">
<link rel="preload" href="/cmql-core/main.2e2595a1.js" as="script">
<link rel="preload" href="/cmql-core/1.0eaafbb4.js" as="script">
<link rel="preload" href="/cmql-core/2.086bcdde.js" as="script">
<link rel="preload" href="/cmql-core/52.fe66fd41.js" as="script">
<link rel="preload" href="/cmql-core/53.91d632f3.js" as="script">
<link rel="preload" href="/cmql-core/935f2afb.7c2f70d3.js" as="script">
<link rel="preload" href="/cmql-core/17896441.d6ed6c30.js" as="script">
<link rel="preload" href="/cmql-core/492852b6.882a0db3.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/cmql-core/"><img class="navbar__logo" src="/cmql-core/img/logo.png" alt="cMQL"><strong class="navbar__title">cMQL</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/cmql-core/docs/">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2aTZ"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_BsTx">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_BsTx">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/cmql-core/"><img class="navbar__logo" src="/cmql-core/img/logo.png" alt="cMQL"><strong class="navbar__title">cMQL</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/cmql-core/docs/">Docs</a></li><li class="menu__list-item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_2gpo"><div class="docSidebarContainer_3_JD" role="complementary"><div class="sidebar_2urC"><div class="menu menu--responsive menu_5FrY"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_Dm3K" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Intro</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/cmql-core/docs/intro/guide">Documentation guide</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/cmql-core/docs/">What is cMQL?</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/cmql-core/docs/intro/why">Why cMQL?</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">cMQL</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cmql-core/docs/cMQL/intro">Intro</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cmql-core/docs/cMQL/notation">Notation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cmql-core/docs/cMQL/operators">Operators</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cmql-core/docs/cMQL/stages">Stages</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cmql-core/docs/cMQL/arguments">Arguments</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cmql-core/docs/cMQL/commands">Commands and Methods</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Generate MQL</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cmql-core/docs/cmqltool/generatemql">cMQL as Tool</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">cMQL Apps</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cmql-core/docs/cqmlapp/intro">Intro</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cmql-core/docs/cmqlapp/javaapp">Java</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cmql-core/docs/cmqlapp/clojureapp">Clojure</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cmql-core/docs/cmqlapp/nodejsapp">Nodejs</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cmql-core/docs/cmqlapp/clojurescriptapp">Clojurescript</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">API</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cmql-core/docs/api/cmql-j">cmql-j</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cmql-core/docs/api/cmql-js">cmql-js</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Server side</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cmql-core/docs/javascript-clojurescript/javascript">Server side javascript</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cmql-core/docs/javascript-clojurescript/functions">Server side functions</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Encode-Decode</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cmql-core/docs/encodedecode/intro">Intro</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cmql-core/docs/encodedecode/cmql-j">cMQL-j</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Extras</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cmql-core/docs/extras/intro">Intro</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cmql-core/docs/extras/arrays">Arrays</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cmql-core/docs/extras/groups">Groups</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cmql-core/docs/extras/nested">Nested</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Contribute</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cmql-core/docs/development/contribute">Future goals</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3EyW"><div class="container padding-vert--lg docItemWrapper_1EkI"><div class="row"><div class="col docItemCol_2ASc"><div class="docItemContainer_3QWW"><article><header><h1 class="docTitle_1Lrw"> </h1></header><div class="markdown"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="why-cmql"></a>Why cMQL<a aria-hidden="true" tabindex="-1" class="hash-link" href="#why-cmql" title="Direct link to heading">#</a></h2><ul><li>less code up to <strong>3x</strong></li><li>clear structure  </li><li>clear notation  </li></ul><p>For the 3 basic reasons see <a href="/cmql-core/docs/cmqltool/cmqltool">what is cMQL</a> and the examples on <a href="/cmql-core/docs/intro/www.cmql-live.org">cMQL-live</a>    </p><p>The other 3 reasons are that cMQL is</p><ul><li>good choice for querying/data processing in general  </li><li>like MQL with (), both are functional homoiconic   </li><li>simple,provides easy interop and portable queries because it uses Clojure features</li></ul><p>Here we will focus on those 3 reasons </p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="queringdata-processing"></a>Quering,Data processing<a aria-hidden="true" tabindex="-1" class="hash-link" href="#queringdata-processing" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="data-software"></a>Data software<a aria-hidden="true" tabindex="-1" class="hash-link" href="#data-software" title="Direct link to heading">#</a></h3><ul><li>MongoDB choosed MQL , a functional <a href="https://en.wikipedia.org/wiki/Homoiconicity" target="_blank" rel="noopener noreferrer">homoiconic</a>  language<ul><li><a href="https://docs.mongodb.com/manual/reference/command/" target="_blank" rel="noopener noreferrer">Commands</a></li><li><a href="https://docs.mongodb.com/manual/reference/operator/" target="_blank" rel="noopener noreferrer">Query operators</a><br>MQL is not a general programming language, it is missing feautures, but looks like functional programming.     </li></ul></li><li>Apache Hadoop is based on map reduce that comes from functional programming  </li><li>Apache Spark is made in Scala  </li><li>Apache Kafka is made in Java,Scala  </li><li>RethinkDB chose <a href="https://rethinkdb.com/docs/introduction-to-reql/#reql-queries-are-functional" target="_blank" rel="noopener noreferrer">ReQL</a> to be functional  </li></ul><p>The reason is because data processing using pipelines is a form of functional programming.<br>
Also functional programming avoids mutable state,making parallel data processing easier.     </p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="functional-programming"></a>Functional programming<a aria-hidden="true" tabindex="-1" class="hash-link" href="#functional-programming" title="Direct link to heading">#</a></h3><p>Functional programming</p><ul><li>we use a series of nested calls,instead of making a series of assignments
(we use constants,the result of a function doesn&#x27;t update the state of a variable,it goes to the next function as argument)</li><li>we have independed functions that we use as arguments, or we return functions  </li></ul><p>*we can have mutable state and we can have names to hold a value,but the above are the main way of functional programming.    </p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="data-processing"></a>Data processing<a aria-hidden="true" tabindex="-1" class="hash-link" href="#data-processing" title="Direct link to heading">#</a></h3><p>Data processing can be seen as a form of functional programming   </p><ul><li>we use nested calls for pipelines (data goes from one function to the next)  </li><li>we have independed functions that we use as arguments to define the trasformations
(functions as arguments,for example map/filter/reduce etc)</li></ul><p>On data processing,we focus on returning data,and less on returning functions.  </p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="pipelines"></a>Pipelines<a aria-hidden="true" tabindex="-1" class="hash-link" href="#pipelines" title="Direct link to heading">#</a></h2><p>In data processing commonly use 2 types of pipelines     </p><ul><li>1 data source (like aggregation stages)<br>(function takes as input the output of 1 function only)</li><li>many data sources (like aggregation operators)<br>(function takes as input the output of many functions,arguments that are function calls)</li></ul><p>Pipeline programming is <a href="https://en.wikipedia.org/wiki/Pipeline_(software)#Other_considerations" target="_blank" rel="noopener noreferrer">a form of functional programming.</a><br>
The <a href="https://en.wikipedia.org/wiki/Pipeline_(software)" target="_blank" rel="noopener noreferrer">output of a function become input to the next function.</a>   </p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="1-data-source"></a>1 data source<a aria-hidden="true" tabindex="-1" class="hash-link" href="#1-data-source" title="Direct link to heading">#</a></h3><p>One data source like aggregation stages in MQL
Each function, has max 1 function call as argument,and possible more
arguments that are not function calls.  </p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-text codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">(f3 (f2 (f1 arg1)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        arg2</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        arg3)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    arg4)</span></div></div></div></div></div><p>Because the tree is almost like a line(extra arguments are just leaves,not trees),
we can use a &quot;trick&quot; and make the nested calls to look like a line.   </p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-text codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">   data -&gt; f1 -&gt; f2 -&gt;f3 ....-&gt; final_data</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   (-&gt; (f1 data) f2 f3 ...)                        ;;clojure </span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   tranform(f1).transform(f2).transform(f3)...     ;;Java8+,we need lambdas   </span></div></div></div></div></div><p>This allows us to avoid the nested calls,for the simple case that we have max 1
function call as argument.   </p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="many-data-sources"></a>Many data sources<a aria-hidden="true" tabindex="-1" class="hash-link" href="#many-data-sources" title="Direct link to heading">#</a></h3><p>Many data sources like aggregate operators.<br>
A function that can take inputs that are results of other function calls.  </p><p>The above trick cannot work here,or even if we try to make a tree look like a line,
it would so hard to understand what it does(we would have to imagine the tree structure).   </p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="nested-syntax"></a>Nested syntax<a aria-hidden="true" tabindex="-1" class="hash-link" href="#nested-syntax" title="Direct link to heading">#</a></h3><p>When we nest code,we need the programming language syntax,to make it readable for us.   </p><p>How we nest things?<br>
We start with a symbol that symbolize the nesting level,and inside it we put the code      </p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="example"></a>Example<a aria-hidden="true" tabindex="-1" class="hash-link" href="#example" title="Direct link to heading">#</a></h4><div><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_1w39 tabs__item--active" style="outline:none">{.</li><li role="tab" tabindex="0" aria-selected="false" class="tabs__item tabItem_1w39" style="outline:none">.{</li><li role="tab" tabindex="0" aria-selected="false" class="tabs__item tabItem_1w39" style="outline:none">.(</li><li role="tab" tabindex="0" aria-selected="false" class="tabs__item tabItem_1w39" style="outline:none">(.</li></ul><div role="tabpanel" class="margin-vert--md"><div><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-text codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">{</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  st1</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  st2</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    st3</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    st4</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">       st5</span></div><div class="token-line" style="color:#393A34"><span class="token plain">       st6</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">}</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">where =&gt; read { special symbol     (find nested level)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">what  =&gt; read inside what it does  (find what the code does)</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">We also need to check more outer or more inner levels to get the whole picture  </span></div></div></div></div></div></div></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="query-example"></a>Query example<a aria-hidden="true" tabindex="-1" class="hash-link" href="#query-example" title="Direct link to heading">#</a></h4><p>we know that &quot;takis&quot; employer of dept 1,has a new child {:name &quot;elpida&quot; :age 2}
and we want to add it.    </p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-text codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">(insert :testdb.testcoll</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        {:dept 1</span></div><div class="token-line" style="color:#393A34"><span class="token plain">         :employers [{:id 1</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                      :name &quot;takis&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                      :children [{:name &quot;nikos&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                                  :age 5}</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                                 {:name &quot;helen&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                                  :age 8}]}]})</span></div></div></div></div></div><div><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="false" class="tabs__item tabItem_1w39" style="outline:none">(. cMQL</li><li role="tab" tabindex="0" aria-selected="false" class="tabs__item tabItem_1w39" style="outline:none">.(</li><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_1w39 tabs__item--active" style="outline:none">cMQL assoc-in</li></ul><div role="tabpanel" class="margin-vert--md"><div><p>cMQL has an operator to make easy read/update nested documents/arrays easy  </p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-text codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">(update- :testdb.testcoll</span></div><div class="token-line" style="color:#393A34"><span class="token plain">         (uq (= :dept 1)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">             (replace-root (assoc-in :ROOT. [&quot;employers&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                                             {:icond (= :v.name. &quot;takis&quot;)}</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                                             &quot;children&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                                             {:icond (count :a.)}]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                                     {:name &quot;elpida&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                                     :age 2}))))</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">It means</span></div><div class="token-line" style="color:#393A34"><span class="token plain">- get key employers   </span></div><div class="token-line" style="color:#393A34"><span class="token plain">- get index X , where the element(:v.) in position X has (:v.name. &quot;takis&quot;)   </span></div><div class="token-line" style="color:#393A34"><span class="token plain">- get key &quot;children&quot;    </span></div><div class="token-line" style="color:#393A34"><span class="token plain">- get index X , where it equals with the end of the array </span></div><div class="token-line" style="color:#393A34"><span class="token plain">  (we want to add in end of unknow size array)   </span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">They are very easy to use, for more see Collections/Nested  </span></div></div></div></div></div></div></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="mql"></a>MQL<a aria-hidden="true" tabindex="-1" class="hash-link" href="#mql" title="Direct link to heading">#</a></h4><p>MQL is nested language(aggregate operators can take many arguments,we cant just put them in line like stages),
data processing is nested programming, so we will be nesting code anyways, and this is where cMQL can help.    </p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="clojure"></a>Clojure<a aria-hidden="true" tabindex="-1" class="hash-link" href="#clojure" title="Direct link to heading">#</a></h2><p>Reasons for selecting Clojure for cMQL   </p><p>The above was about why functional programming helps on data processing<br>
The bellow are how Clojure&#x27;s features and similarities with MQL helped on making cMQL    </p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="functional-and-homoiconic"></a>Functional and homoiconic<a aria-hidden="true" tabindex="-1" class="hash-link" href="#functional-and-homoiconic" title="Direct link to heading">#</a></h3><p>For the reasons above, functional programming supports data processing.  </p><p>Homoiconic</p><ul><li>means that the code is written in language data structures.  </li><li>homoiconic languages have very simple syntax
(code in clojure is lists and vectors,code in MQL is maps and arrays)</li><li>we can do meta programming with them,process code,to generate code<br>(see bellow macros)    </li><li>MQL is homoiconic also,so it looked natural fit (see below)  </li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="mql-similarities"></a>MQL similarities<a aria-hidden="true" tabindex="-1" class="hash-link" href="#mql-similarities" title="Direct link to heading">#</a></h3><p>Both are functional and homoiconic (code is written in language data structures)<br>
Both are also made to be easy to use them with other languages.    </p><p>The programming style is exactly the same, and Clojure experience can be used in MQL,
or the opposite, if someone likes MQL its very likely to like Clojure also.  </p><p>MQL looks like Clojure in {}
MQL uses {f-name ...} Clojure uses (f-name ...)</p><p>MQL</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-text codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">{&#x27;$setIntersection&#x27; : [&#x27;$w&#x27; ,&#x27;$z&#x27;]}</span></div></div></div></div></div><p>cMQL</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-text codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">(intersection :w :z)</span></div></div></div></div></div><p>cMQL wraps MQL without changing the programming style.  </p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="json-like-literals"></a>JSON like literals<a aria-hidden="true" tabindex="-1" class="hash-link" href="#json-like-literals" title="Direct link to heading">#</a></h3><p>In Clojure we have clojure-maps,we can use them to represent data,that we will insert.  </p><p>Clojure has many data structures like lists/vectors/sets/maps.  </p><p>We can write cMQL queries but whenever we want we can use raw MQL also inside the
cMQL queries</p><p>For example we could write even very mixed code like the bellow,stage operator in MQL,reference in cMQL,
one aggregate operator in cMQL the other in MQL.  </p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-text codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">(q acoll</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   {&quot;$addfields&quot; {:a (+ 1 {&quot;$add&quot; [2 3]})}})</span></div></div></div></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="macros"></a>Macros<a aria-hidden="true" tabindex="-1" class="hash-link" href="#macros" title="Direct link to heading">#</a></h3><p>Clojure has powerful macros,as a homoiconic language we are allowed to write code
that will generate code.Macros run before running the clojure code,and they produce
the final source code.   </p><p>Macros are very important on making &quot;new languages&quot;.<br>
This way the user can write much less code,or can write even invalid Clojure code,
that the macro will process to produce the valid Clojure code.  </p><p>With macros,we are free to make the new language as we wanted to be.
For example macros allowed as to use language core names like reduce/map/let etc.  </p><p>In cMQL we do </p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-text codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">(map (fn [:m.] (* (+ :m. 1) 2)) :myarray)</span></div></div></div></div></div><p>Not</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-text codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">(m-map (m-fn [:m.] (mul (add :m. 1)) :myarray))</span></div></div></div></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="keywords"></a>Keywords<a aria-hidden="true" tabindex="-1" class="hash-link" href="#keywords" title="Direct link to heading">#</a></h3><p>In clojure we have keywords.
Here we use them for fields and variables.  </p><p>:myfield = field reference
:myvar.  = a var (has a . in the end or in start like  :.myvar)</p><p>This allowed us to not use the &quot;$$&quot; &quot;$&quot; that is hard to read.  </p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="simple-and-practical"></a>Simple and practical<a aria-hidden="true" tabindex="-1" class="hash-link" href="#simple-and-practical" title="Direct link to heading">#</a></h3><p>It allowed us to remove MQL verbosity,without inventing a new language.<br>
The simple Clojure&#x27;s way was used.    </p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-text codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">  (reduce (fn [sum n] (+ sum n)) [] myarray)               ; clojure</span></div></div></div></div></div><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-text codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">  (reduce (fn [:sum. :n.] (+ :sum. :n.)) [] :myarray)      ; cMQL</span></div></div></div></div></div><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-text codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">  {&quot;$reduce&quot; {&quot;input&quot; &quot;$myarray&quot;,                          ; MQL</span></div><div class="token-line" style="color:#393A34"><span class="token plain">              &quot;initialValue&quot; [],</span></div><div class="token-line" style="color:#393A34"><span class="token plain">              &quot;in&quot; {&quot;$let&quot; {&quot;vars&quot; {&quot;sum&quot; &quot;$$value&quot;, &quot;n&quot; &quot;$$this&quot;},</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                            &quot;in&quot; {&quot;$add&quot; [&quot;$$sum&quot; &quot;$$n&quot;]}}}}}</span></div></div></div></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="run-in-many-drivers"></a>Run in many Drivers<a aria-hidden="true" tabindex="-1" class="hash-link" href="#run-in-many-drivers" title="Direct link to heading">#</a></h3><p>Clojure is made to be a hosted language,it doesn&#x27;t just runs in JVM for example,
Clojure is made for the JVM,and Clojurescript is made for Javascript.  </p><p>We also have many Clojure&#x27;s,cMQL works only for java/js for now.<br>
This allows us easy interop,and portable cMQL queries between the drivers cMQL supports .  </p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="comparison"></a>Comparison<a aria-hidden="true" tabindex="-1" class="hash-link" href="#comparison" title="Direct link to heading">#</a></h2><p>cMQL uses clojure features and the similarities with MQL to make the query builder simple.  </p><p>If java or javascript was used to make the query builder  </p><ul><li>not functional, not natural for querying and data processing       </li><li>not readable nesting of function calls    </li><li>not like MQL different syntax, programming model     </li><li>no JSON literals   </li><li>no macros,to make the query builder less verbose     </li><li>no keywords,to use for the fields     </li><li>queries would run only in java or only in javascript   </li></ul><p>The result would be a verbose,not portable query builder,not suitable for data processing<br>
That would be also harder to make.   </p><p>Query builders that we have can be very incomplete also.   </p><p>Queries bellow are so simple and so small like 5 lines,cMQL goes ~2x even in simple queries,<br>
but cMQL is not just a way to make easy queries very easy,for big or complex queries,
it is a way to avoid &quot;code explosion&quot; see also <a href="/cmql-core/docs/#example-3">example3</a> <a href="/cmql-core/docs/#example-4">example4</a>       </p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="java"></a>Java<a aria-hidden="true" tabindex="-1" class="hash-link" href="#java" title="Direct link to heading">#</a></h3><ul><li>Java Mongodb official driver<br>doesn&#x27;t cover most aggregate operators(only stages/filters(some query operators)/accumulators)<br>We have like 100+ aggregate operators more that we have to write MQL to use them<br>(there is no let/map/reduce/filter etc)       </li><li>java is not like MQL making a java query builder is harder  </li></ul><p>Small example in Java only with covered operators (if not covered we could go 4x+)</p><p>cMQL = 79 characters<br>
Java Query = 188 characters (~2x)    </p><div><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_1w39 tabs__item--active" style="outline:none">cMQL</li><li role="tab" tabindex="0" aria-selected="false" class="tabs__item tabItem_1w39" style="outline:none">Java Query Builder</li></ul><div role="tabpanel" class="margin-vert--md"><div><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-text codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">(q zips</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   (= :state &quot;TX&quot;)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   (group :city {:totalPop :pop}</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   [:!_id :totalPop]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   (sort :!totalPop)))</span></div></div></div></div></div></div></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="mongoose"></a>Mongoose<a aria-hidden="true" tabindex="-1" class="hash-link" href="#mongoose" title="Direct link to heading">#</a></h3><ul><li>Mongoose supports JSON like literals,and and raw MQL is generaly used.</li><li>Query builder offers even less than the Java one.  </li><li>The result is a mix of MQL with the query builder.  </li></ul><p>It has the problems of MQL <a href="/cmql-core/docs/">for more see the examples</a></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="spring-data-mongodb"></a>Spring Data MongoDB<a aria-hidden="true" tabindex="-1" class="hash-link" href="#spring-data-mongodb" title="Direct link to heading">#</a></h3><p><a href="https://docs.spring.io/spring-data/mongodb/docs/current/reference/html/#reference" target="_blank" rel="noopener noreferrer">Spring data MongoDB</a> query builder offers
aggregator operators.   </p><p>cMQL = 92 characters<br>
Spring = 180 characters (2x)  </p><div><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_1w39 tabs__item--active" style="outline:none">cMQL</li><li role="tab" tabindex="0" aria-selected="false" class="tabs__item tabItem_1w39" style="outline:none">Spring Query Builder</li></ul><div role="tabpanel" class="margin-vert--md"><div><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-text codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">(q coll</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   [:firstname</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    :lastname</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    {:created (map (fn [:u.] (str :u.firstname. &quot; &quot; :u.lastname.)) :created)}])</span></div></div></div></div></div></div></div></div><p>Even in so small example we can see many of the problems described above  </p><ul><li>map is not clear</li><li>the function that we will use is not clear the body and the arguments</li><li>the nesting is not clear</li><li>we have extra words like and/as/valueOf/concatValueOf/andApply,</li><li>we also have a mixed notation of references and variables with &quot;$$&quot;,&quot;$&quot;   </li></ul><p>And its not Spring query builder problem,the problem is that we dont have macros,
to make a nice query builder, and we try to wrap MQL(functional homoiconic) with
a procedural language,and then write functional code with it.    </p></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/cmql-core/docs/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â«  </div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/cmql-core/docs/cMQL/intro"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">  Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3SO_"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#why-cmql" class="table-of-contents__link">Why cMQL</a></li><li><a href="#queringdata-processing" class="table-of-contents__link">Quering,Data processing</a><ul><li><a href="#data-software" class="table-of-contents__link">Data software</a></li><li><a href="#functional-programming" class="table-of-contents__link">Functional programming</a></li><li><a href="#data-processing" class="table-of-contents__link">Data processing</a></li></ul></li><li><a href="#pipelines" class="table-of-contents__link">Pipelines</a><ul><li><a href="#1-data-source" class="table-of-contents__link">1 data source</a></li><li><a href="#many-data-sources" class="table-of-contents__link">Many data sources</a></li><li><a href="#nested-syntax" class="table-of-contents__link">Nested syntax</a></li></ul></li><li><a href="#clojure" class="table-of-contents__link">Clojure</a><ul><li><a href="#functional-and-homoiconic" class="table-of-contents__link">Functional and homoiconic</a></li><li><a href="#mql-similarities" class="table-of-contents__link">MQL similarities</a></li><li><a href="#json-like-literals" class="table-of-contents__link">JSON like literals</a></li><li><a href="#macros" class="table-of-contents__link">Macros</a></li><li><a href="#keywords" class="table-of-contents__link">Keywords</a></li><li><a href="#simple-and-practical" class="table-of-contents__link">Simple and practical</a></li><li><a href="#run-in-many-drivers" class="table-of-contents__link">Run in many Drivers</a></li></ul></li><li><a href="#comparison" class="table-of-contents__link">Comparison</a><ul><li><a href="#java" class="table-of-contents__link">Java</a></li><li><a href="#mongoose" class="table-of-contents__link">Mongoose</a></li><li><a href="#spring-data-mongodb" class="table-of-contents__link">Spring Data MongoDB</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/cmql-core/docs/intro/what">What is cMQL?</a></li><li class="footer__item"><a class="footer__link-item" href="/cmql-core/docs/intro/why">Why cMQL?</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Contact</h4><ul class="footer__items"><li class="footer__item"><a href="https://discord.gg/zWDzp4B7Bf" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord</a></li><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="/cmql-core/docs/intro/tkaryadis@gmail.com">tkaryadis@gmail.com</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">GitHub</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/tkaryadis/cmql-core" target="_blank" rel="noopener noreferrer" class="footer__link-item">cMQL-core</a></li><li class="footer__item"><a href="https://github.com/tkaryadis/cmql-j" target="_blank" rel="noopener noreferrer" class="footer__link-item">cMQL-j</a></li><li class="footer__item"><a href="https://github.com/tkaryadis/cmql-js" target="_blank" rel="noopener noreferrer" class="footer__link-item">cMQL-js</a></li></ul></div></div><div class="text--center"><div>Copyright 2021 Takis Karyadis</div></div></div></footer></div>
<script src="/cmql-core/styles.feaccdac.js"></script>
<script src="/cmql-core/runtime~main.d60d5b06.js"></script>
<script src="/cmql-core/main.2e2595a1.js"></script>
<script src="/cmql-core/1.0eaafbb4.js"></script>
<script src="/cmql-core/2.086bcdde.js"></script>
<script src="/cmql-core/52.fe66fd41.js"></script>
<script src="/cmql-core/53.91d632f3.js"></script>
<script src="/cmql-core/935f2afb.7c2f70d3.js"></script>
<script src="/cmql-core/17896441.d6ed6c30.js"></script>
<script src="/cmql-core/492852b6.882a0db3.js"></script>
</body>
</html>